<!DOCTYPE html>

<html>
	<head>
		<meta name="viewport" content="width=device-width,initial-scale=1">
		<title>Home Page</title>
		<meta charset="utf-8">
		<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
		<link rel="stylesheet" type="text/css" href="home_page_css.css">
		<script type="text/javascript" src="main.js"></script>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
	</head>
	<body>
		<div class = "container-fluid">
			<h class = "title" id = "hospital_name">Welcome to UCI Medical Center</h>
			<script>
				var h_username = localStorage.email;
				var sys = localStorage.getItem('sys');
				sys = JSON.parse(sys);
				var h_index = 0;
				// h_index = sys.findRecord(sys.h_username);
				var total_records = sys.allHospitals.length;
				for (let i = 0; i < total_records; i++) {
					if (sys.allHospitals[i].username == h_username) {
						h_index = i;
					}
				}
				localStorage.setItem('sys', JSON.stringify(sys));
				document.getElementById("hospital_name").innerHTML = sys.allHospitals[h_index].name;
			</script>
			 <ul>
			 	  <li><a class="active" href="home_page.html">Home</a></li>
				  <li><a href="create_record.html">Create a New Patient</a></li>
				  <li><a href="visit_record.html">Create a New Visit</a></li>
				  <li><a href="send_data.html">Send Patient Data</a></li>
			</ul>
			<div class = "row bow">
				<h1 class = "mid_title">Most Recent Visits</h1>
				<a href="patient_info.html"><p id = "first" class = "name_hm"></p></a>
				<a href="patient_info.html"><p id = "second" class = "name_hm"></p></a>
				<a href="patient_info.html"><p id = "third" class = "name_hm"></p></a>
				<a href="patient_info.html"><p id = "fourth" class = "name_hm"></p></a>
			</div>
			<script>
				var sys = localStorage.getItem('sys');
				sys = JSON.parse(sys);
				var h_username = localStorage.email;
				var h_index = 0;
				var total_records = sys.allHospitals.length;
					for (let i = 0; i < total_records; i++) {
						if (sys.allHospitals[i].username == h_username) {
							h_index = i;
						}
					}
				var total_patients = sys.allHospitals[h_index].patients.length;
				--total_patients;
				// var num = sys.allHospitals[h_index].patients[0].records.length;
				// var minimum = sys.allHospitals[h_index].patients[0].records[num].date;
				// for (let i = 1; i < total_patients; ++i ) {
				// 	var num = sys.allHospitals[h_index].patients[i].records.length;
				// 	if (sys.allHospitals[h_index].patients[i].records[num-1].date.getTime() < min) {
				// 		minimum = sys.allHospitals[h_index].patients[i].records[num-1].date;
				// 	}
				// }
				document.getElementById("first").innerHTML = sys.allHospitals[h_index].patients[total_patients].name;
				document.getElementById("second").innerHTML = sys.allHospitals[h_index].patients[total_patients - 1].name;
				document.getElementById("third").innerHTML = sys.allHospitals[h_index].patients[total_patients - 2].name;
				document.getElementById("fourth").innerHTML = sys.allHospitals[h_index].patients[total_patients - 3].name;
				document.getElementById("fifth").innerHTML = sys.allHospitals[h_index].patients[total_patients - 4].name;
				document.getElementById("sixth").innerHTML = sys.allHospitals[h_index].patients[total_patients - 5].name;
				document.getElementById("seventh").innerHTML = sys.allHospitals[h_index].patients[total_patients - 6].name;
				localStorage.setItem('sys', JSON.stringify(sys));
			</script>
		</div>
	</body>

</html>
